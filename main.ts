controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    doAttack()
})
function createEnemy () {
    ghost = sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . 2 2 4 4 2 2 . . . . . . 
        2 . 2 2 4 2 2 2 2 4 2 2 . 2 2 . 
        2 2 2 2 2 2 2 2 2 2 2 2 2 2 . . 
        . 2 2 2 2 4 2 2 4 2 2 2 2 . . . 
        2 2 2 4 2 2 2 2 2 2 4 2 2 2 2 . 
        2 2 2 1 1 2 2 2 2 1 1 2 2 2 . . 
        . 2 1 1 2 1 1 1 1 2 1 1 2 . . . 
        2 2 1 1 2 2 1 1 2 2 1 1 2 2 . . 
        2 2 2 1 2 2 1 1 2 2 1 2 2 2 2 . 
        . . 2 1 1 2 1 1 2 1 1 2 . . . . 
        . . 2 2 2 1 1 1 1 2 2 2 . . . . 
        . 2 2 . . 2 2 2 2 . . 2 2 . . . 
        . . . . 2 2 2 2 2 2 . . . . . . 
        . . . 2 2 2 2 2 2 2 2 . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.Enemy)
    scene.placeOnRandomTile(ghost, 13)
    ghost.setFlag(SpriteFlag.BounceOnWall, true)
    ghost.follow(link, 30)
}
sprites.onOverlap(SpriteKind.Enemy, SpriteKind.Player, function (sprite, otherSprite) {
    if (controller.A.isPressed()) {
        ghost.destroy(effects.fire, 100)
    } else {
        info.changeLifeBy(-1)
        link.setPosition(40, 56)
        ghost.destroy()
    }
})
info.onLifeZero(function () {
    game.over(false, effects.melt)
})
scene.onHitTile(SpriteKind.Player, 15, function (sprite) {
    game.over(true, effects.smiles)
})
sprites.onDestroyed(SpriteKind.Enemy, function (sprite) {
    info.changeScoreBy(1)
    createEnemy()
    pause(500)
})
function doAttack () {
    if (state == "RIGHT") {
        link.setImage(img`
            ................................
            ................................
            ................................
            ......7777......................
            ....77777eeee...................
            ...77477eeeeee..................
            ...7744eeeeee...................
            ..777444e4474...................
            .777ee44e44e4448................
            .7..eee444444..8................
            ....777774444498111111111111....
            ...77eeeeee444981111111111111...
            ...7eeeeeee44898111111111111....
            ..77eeeeeee7...8................
            .7777eee777ee.88................
            ee777777eeeee...................
            eee777777777ee..................
            .eee.......eeee.................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            `)
        pause(200)
        link.setImage(img`
            . . . . . 7 7 7 7 . . . . . . . 
            . . . 7 7 7 7 7 e e e e . . . . 
            . 7 7 7 4 7 7 e e e e e e . . . 
            7 7 7 7 4 4 e e e e e e . . . . 
            7 . 7 7 4 4 4 e 4 4 7 4 . . e . 
            . . 7 e e 4 4 e 4 4 e 4 4 4 e . 
            . . . e e e 4 4 4 4 4 4 . . e . 
            . . . . 7 7 7 7 4 4 4 4 . . e . 
            . . e 7 7 7 7 7 7 7 e e e 4 e . 
            . e e e 7 4 4 4 7 7 7 e e 4 e . 
            . e e e e 4 4 4 7 7 7 e e . e . 
            . e e e e 4 4 7 7 7 e . . . e . 
            . . 7 e e 7 7 e e e e . . . . . 
            . 7 7 7 7 7 7 7 7 7 7 . . . . . 
            . . . . e e e e . . . . . . . . 
            . . . . e e e e e . . . . . . . 
            `)
    } else if (state == "UP") {
        link.setImage(img`
            ................................
            ................................
            ................................
            ......7777......................
            ....77777eeee...................
            ...77477eeeeee..................
            ...7744eeeeee...................
            ..777444e4474...................
            .777ee44e44e4448................
            .7..eee444444..8................
            ....777774444498111111111111....
            ...77eeeeee444981111111111111...
            ...7eeeeeee44898111111111111....
            ..77eeeeeee7...8................
            .7777eee777ee.88................
            ee777777eeeee...................
            eee777777777ee..................
            .eee.......eeee.................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            `)
        pause(200)
        link.setImage(img`
            . . . . . 7 7 7 7 . . . . . . . 
            . . . 7 7 7 7 7 e e e e . . . . 
            . 7 7 7 4 7 7 e e e e e e . . . 
            7 7 7 7 4 4 e e e e e e . . . . 
            7 . 7 7 4 4 4 e 4 4 7 4 . . e . 
            . . 7 e e 4 4 e 4 4 e 4 4 4 e . 
            . . . e e e 4 4 4 4 4 4 . . e . 
            . . . . 7 7 7 7 4 4 4 4 . . e . 
            . . e 7 7 7 7 7 7 7 e e e 4 e . 
            . e e e 7 4 4 4 7 7 7 e e 4 e . 
            . e e e e 4 4 4 7 7 7 e e . e . 
            . e e e e 4 4 7 7 7 e . . . e . 
            . . 7 e e 7 7 e e e e . . . . . 
            . 7 7 7 7 7 7 7 7 7 7 . . . . . 
            . . . . e e e e . . . . . . . . 
            . . . . e e e e e . . . . . . . 
            `)
    } else {
        link.setImage(img`
            ................................
            ................................
            ................................
            ......7777......................
            ....77777eeee...................
            ...77477eeeeee..................
            ...7744eeeeee...................
            ..777444e4474...................
            .777ee44e44e4448................
            .7..eee444444..8................
            ....777774444498111111111111....
            ...77eeeeee444981111111111111...
            ...7eeeeeee44898111111111111....
            ..77eeeeeee7...8................
            .7777eee777ee.88................
            ee777777eeeee...................
            eee777777777ee..................
            .eee.......eeee.................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            `)
        pause(200)
        link.setImage(img`
            . . . . . 7 7 7 7 . . . . . . . 
            . . . 7 7 7 7 7 e e e e . . . . 
            . 7 7 7 4 7 7 e e e e e e . . . 
            7 7 7 7 4 4 e e e e e e . . . . 
            7 . 7 7 4 4 4 e 4 4 7 4 . . e . 
            . . 7 e e 4 4 e 4 4 e 4 4 4 e . 
            . . . e e e 4 4 4 4 4 4 . . e . 
            . . . . 7 7 7 7 4 4 4 4 . . e . 
            . . e 7 7 7 7 7 7 7 e e e 4 e . 
            . e e e 7 4 4 4 7 7 7 e e 4 e . 
            . e e e e 4 4 4 7 7 7 e e . e . 
            . e e e e 4 4 7 7 7 e . . . e . 
            . . 7 e e 7 7 e e e e . . . . . 
            . 7 7 7 7 7 7 7 7 7 7 . . . . . 
            . . . . e e e e . . . . . . . . 
            . . . . e e e e e . . . . . . . 
            `)
    }
}
// * have camera move to new field when Link moves out of screen
// * have enemy kill player when behind player  (turn physics on)
// * have sword kill enemy when in front of sword (turn physics on)
// * Change projectile to arrow
// * have multiple random enemies appear in certain spots and not randomly
let ghost: Sprite = null
let link: Sprite = null
let state = ""
let projectile = null
let toggle = 0
info.setLife(3)
state = "RIGHT"
link = sprites.create(img`
    . . . . . 7 7 7 7 7 7 . . . . . 
    . . . . 7 7 7 7 7 7 7 7 . . . . 
    . . . . 7 e e e e e e 7 . . . . 
    . . 4 . e e e e e e e e . 4 . . 
    . . 4 . e 4 7 4 4 7 4 e . 4 . . 
    . . 4 4 e 4 e 4 4 e 4 e 4 4 . . 
    . . 4 4 e 4 4 4 4 4 4 e 4 4 . . 
    . . . 4 4 4 4 e e 4 4 4 4 e . . 
    . . . 7 7 4 4 4 4 4 4 7 7 e . . 
    . e e e e e 4 4 4 4 7 7 e e e . 
    e e 4 e e e e 7 7 7 7 7 4 e e . 
    e 4 4 4 e e 4 e e 7 7 4 4 4 e . 
    e e 4 e e e 4 7 e e e 7 4 4 4 . 
    e e 4 e e e 4 e e 7 7 7 7 4 . . 
    e e e e e e 4 7 7 7 7 7 . . . . 
    . 4 4 4 4 4 e . . e e e . . . . 
    `, SpriteKind.Player)
link.setPosition(40, 56)
controller.moveSprite(link)
scene.cameraFollowSprite(link)
createEnemy()
createMap()
